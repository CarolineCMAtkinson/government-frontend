<%
  published ||= false
  history ||= []
  history = Array(history)
  last_updated ||= false
  link_to_history ||= false
%>

<div class="app-c-published-dates" <% if history%>id="history" data-module="toggle"<% end %>>
  Published <%= published %>
  <% if last_updated %>
    <% if published %><br /><% end %>
    <%= t('common.last_updated', date: last_updated) %>
    <% if link_to_history && history.empty? %>
      &mdash; <a href="#history"><%= t('common.see_all_updates') %></a>
    <% elsif history.any? %>
      <a href="#full-history" data-controls="full-history" data-expanded="false">&#43;&nbsp;<%= t('common.full_page_history') %></a>
      <div class="app-c-published-dates__change-history js-hidden" id="full-history">
        <ol>
          <% history.each do |change| %>
            <li class="app-c-published-dates__change-item">
              <time class="app-c-published-dates__change-date" datetime="<%= change[:timestamp] %>" class="timestamp"><%= change[:display_time] %></time>
              <%= change[:note] %>
            </li>
          <% end %>
        </ol>
      </div>
    <% end %>
  <% end %>
</div>
